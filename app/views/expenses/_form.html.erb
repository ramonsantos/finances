<%= form_with(model: expense, local: true, html: { onsubmit: normalize_amount }) do |form| %>
  <% if expense.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(expense.errors.count, "error") %> prohibited this expense from being saved:</h2>

      <ul>
        <% expense.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field form-group col-md-6">
    <%= form.label :description, 'Descrição' %>
    <%= form.text_field :description, required: true, class: 'form-control' %>
  </div>

  <div class="field form-group col-md-4">
    <%= form.label :amount, 'Valor' %>
    <%= form.text_field(
      :amount,
      oninput: only_numbers_script,
      required: true,
      class: 'form-control',
      value: formated_amount(expense.amount)
    )%>
  </div>

  <div class="field form-group col-md-4">
    <%= form.label :date, 'Data da Compra' %>
    <%= form.text_field :date, class: 'form-control', type: 'date', value: expense_date(expense) %>
  </div>

  <div class="field form-group col-md-6">
    <div class="form-check">
      <%= form.check_box :fixed, class: 'form-check-input' %>
      <%= form.label :fixed, 'Despesa Fixa?', class: 'form-check-label'%>
    </div>
  </div>

  <div class="field form-group col-md-4">
    <%= form.label :category, 'Categoria' %>
    <%= form.select(
      :category,
      options_for_select(Expense.categories.values, Expense.categories[expense.category]),
      {},
      class: 'form-control'
    )%>
  </div>

  <div class="field form-group col-md-4">
    <%= form.label :place_id, 'Local' %>
    <%= form.select(
      :place_id,
      options_for_select(@places, current_option(expense, :place_id, @places)),
      {},
      class: 'form-control'
    )%>
  </div>

  <div class="field form-group col-md-4">
    <%= form.label :expense_group_id, 'Grupo de Despesa' %>
    <%= form.select(
      :expense_group_id,
      options_for_select(@expense_groups, current_option(expense, :expense_group_id, @expense_groups)),
      {},
      class: 'form-control'
    )%>
  </div>

  <div class="field form-group col-md-12">
    <%= form.label :remark, 'Observações', required: true %>
    <%= form.text_area :remark, class: 'form-control' %>
  </div>

  <%= hidden_field_tag(:expense_month, @current_expense_month) %>

  <div class="actions col-md-2">
    <%= form.submit('Salvar', class: 'btn btn-primary') %>
  </div>
<% end %>

<%= javascript_pack_tag 'expenses' %>
